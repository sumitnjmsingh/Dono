"use strict";(()=>{var M=!1,ne=10,g=null;try{g=window;let e=null,t=0;for(;t<ne&&(g?.parent?.window&&g?.parent!==g);){e=g.parent;let n=null,o=e.document.getElementsByTagName("iframe");for(let r=0;r<o.length;r++){let i=o[r];i.contentWindow===g&&(n=i)}if(M=!!n,!o?.length||!M)break;g=g.parent.window,t++}}catch{}function W(){return window?.TEST_API_SERVER_DOMAIN||"api.dable.io"}function j(){return window?.TEST_AD_LOGGING_SERVER_DOMAIN||"ad-log.dable.io"}function q(){return location?.protocol==="https:"?"https:":"http:"}function L(){let e=null,t=null;M?(t=window.parent.window,e=window.parent.document):(t=window,e=document);let n=0;return typeof t.pageYOffset=="number"?n=t.pageYOffset:e.documentElement?.scrollTop?n=e.documentElement.scrollTop:e.body?.scrollTop&&(n=e.body.scrollTop),n}function P(){let e;M?e=util.rootWindow():e=window;let t=e.document.body,n=e.document.documentElement||document.body;return{viewport:e.innerHeight||n.clientHeight,window:Math.max(t.scrollHeight,t.offsetHeight,n.clientHeight,n.scrollHeight,n.offsetHeight)}}function h(e){try{window.console.log(`Dable DEBUG: ${e}`)}catch{}}var T=class{constructor(t){this.executor=t}execute(t){let n=Array.prototype.shift.apply(t);this.executor[n]?this.executor[n].apply(this.executor,t):h(`\uC874\uC7AC\uD558\uC9C0 \uC54A\uB294 \uBA85\uB839\uC785\uB2C8\uB2E4: ${n}`)}push(t){if(Array.isArray(t[0])){for(let n=0;n<t.length;n++){let o=t[n];this.push(o)}return}return this.execute(t)}};var ie=function(){let e=0;return()=>++e}();function oe(e){let t=document.createElement("script"),n=!1;t.src=e,t.async=!0,t.onload=()=>{n||(n=!0,t.onload=null,t?.parentNode?.removeChild(t))},document.head.appendChild(t)}function k(e,t){let n=[];return Array.isArray(t)?t.forEach((o,r)=>{let i=k(`${e}[${r}]`,o);i&&n.push(i)}):t&&typeof t=="object"?Object.keys(t).forEach(o=>{let r=k(`${e}[${o}]`,t[o]);r&&n.push(r)}):e&&n.push(encodeURIComponent(e)+"="+encodeURIComponent(String(t))),n.join("&")}function $(e,t={},n){let o=[];Object.keys(t||{}).forEach(i=>{let s=k(i,t[i]);s&&o.push(s)});let r=`_dbljson${ie()}`;return typeof window=="object"&&(window[r]=i=>{n?.(i)}),o.push(`callback=${r}&_=${Date.now()}`),oe(`${e}?${o.join("&")}`),r}function u(e){let n=new RegExp(`\\b${e}=(.*?)(?:[,;]|$)`).exec(document.cookie);return n&&n[1]&&n[1]!=="null"?n[1]:""}function _(e,t,n=60){let o=new Date(Date.now()+n*1e3),r=location.hostname.split("."),i=Math.max(0,r.length-2)+1;for(;--i>=0;){let s=r.slice(i).join("."),c=`${e}=${t}; path=/; domain=${s}; expires=${o.toUTCString()};`;if(document.cookie=c,u(e))return}}function re(e){if(window.gtag)return;let t=document.createElement("script");t.async=!0,t.src=`https://www.googletagmanager.com/gtag/js?id=${e}`;let n=document.createElement("script");n.innerHTML='window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments)}gtag("js", new Date())',document.head.appendChild(t),document.head.appendChild(n)}function X(e,t){if(!e)return;re(e);let n={send_to:e,...t};try{gtag("config",e),gtag("event","page_view",n)}catch{}}function K(e,t,n=20){let r=e-t,i=e>0?Math.floor(r/400):0;return Math.min(i,n-1)}function se(e){let t,n,o=null,r,i="G",s=["MDK77FHMS5","0WBKEJ0RS9","4KP3M9S35E","HZTVRE3QMR","7NS7KV1CKM","0HJXDNR6TP","5HJSY0GGGQ","RR0JGJWWVS","2NRTFCWHZX","JXDCE1T5M4"],c=["ZBJ7JX11PL","TH9DNLM4ST","RBLEQ9SYXS","H50HXHNWK6","KGMEQNKMPR","LL1S649PC7","PN4GCNT1WZ","8801MDGFCX","R6J3ZGR5YV","0ZLWSJ955R","Q73XC0PFZZ","R10748GL9Y","GS31TDW2S2","KMPPLRHJH5","79C1V7Q4Z0","6CKWRT2JS7","QG18F88RWX","YMFLW158KN","B13LD3ESNR","CJCVTN52FS"];if(e<=4e3)t=0,n=s;else if(e<=12e3)t=4e3,n=c;else if(e<=16e3)t=12e3,n=s;else if(e<=24e3)t=16e3,n=c;else return null;return r=K(e,t),r===null?null:(o=i+"-"+n[r],o)}function Q(e,t,n){if(e==="worldvision.or.kr"||e==="pickup"||n===void 0||e===void 0)return;let o={dimension1:n,dimension2:t},r=se(n);X(r,o)}function de(e){let{platform:t,platformVersion:n,wow64:o,mobile:r,model:i}=e,s=n.replace(/\./g,"_");if(t==="Android"&&r)return`Linux; Android ${s}; ${i}`;if(t==="macOS")return`Macintosh; Intel Mac OS X ${s}`;if(t==="Windows"){let c=n.split("."),l=parseInt(c[0]),f=o?"WOW64":"Win64; x64";return l>0?`Windows NT 10.0; ${f}`:`Windows NT 6.${c[1]}; ${f}`}return t==="Chrome OS"?`X11; CrOS x86_64 ${n}`:t==="Linux"?"X11; Linux x86_64":`${t} ${n}`}function B(){let e=navigator.userAgentData,t=Promise.resolve("");if(!e||!e.getHighEntropyValues)return t;let n=Number(e.brands.find(o=>o.brand==="Chromium")?.version);return!n||n<101?t:e.getHighEntropyValues(["mobile","platformVersion","platform","fullVersionList","model","wow64"]).then(o=>{let r=o.fullVersionList.find(c=>c.brand==="Chromium")?.version,i=de(o),s=navigator.userAgent.replace(/\bChrome\/[\d.]+/,`Chrome/${r}`).replace(/^(Mozilla\/5\.0) \(.+?\)/,`$1 (${i})`);return navigator.userAgent!==s?s:""})}function ae(e,t){return e=e%1?Math.round(e):e,Math.min(e,Math.floor(t))}function ue(e={}){let{min:t,max:n}=e;return e.digits&&(t=Math.pow(10,e.digits-1),n=Math.pow(10,e.digits)-1),(t===void 0||n===void 0)&&(t=0,n=1),{min:t,max:n}}function le({min:e,max:t,scalingFactor:n}){return e+n*(t-e)}function fe(){let e=window.crypto||window.msCrypto;if(!(e&&e.getRandomValues))return Math.random();let t=4294967295,n=new Uint32Array(1);return e.getRandomValues(n),n[0]/t}function A(e={}){let t=fe(),{min:n,max:o}=ue(e),r=le({min:n,max:o,scalingFactor:t});return e.digits?ae(r,o):r}var me=String(Math.round(A()*1e8)),he=1e3*10,V=1e3*60*30,pe=1e3*60*60*24*30,b=!1,x=null,w=null,Y=!1,Z=!0,G=null,C=e=>{let t=null;try{t=decodeURIComponent(e)}catch{t=unescape(e)}return t};function S(e,t){let n,{client_name_or_account_id:o,event_type:r,data:i={},uid:s,cid:c,cached_click:l,cached_conversion:f,client_id:v,items:O}=e;i===null&&(i={});let N=C(window?.location?.href||"");if(N.indexOf("dablena=NATEST")>-1)return;let d=window?.location?.href?.match(/[\?\&]utm_[a-z]+=[^\#\&]+/g);l||f?(n=(l||f).split("|"),n.unshift("")):n=N.match(/[\?\&]dablena=([^\|]+)\|([^\|]+)\|([^\|]+)\|([^\|]+)\|([^\|\#\&]+)\|([^\|\#\&]+)(?:\|([^\|\#\&]+))(?:\|([^\|\#\&]+))(?:\|(\d+))?/);let p=document?.referrer||"";p.indexOf("api.dable.io/widgets")>-1?(s=C(p.split("/")[7]?.split("?")[0]||"")||s,i.widget_id=p.split("/")[5],i.service_name=n?.[3]||C(p.match(/[\?\&]site=([^\#\&]+)/)?.[1]||""),i.campaign_id=n?.[4]||"",i.content_id=n?.[5]||"",i.method=n?.[6]||"",i.channel=n?.[7]||"",i.request_id=n?.[8]||""):n&&(s=n?.[1]||s,i.widget_id=n?.[2],i.service_name=n?.[3],i.campaign_id=n?.[4]||"",i.content_id=n?.[5]||"",i.method=n?.[6]||"",i.channel=n?.[7]||"",i.request_id=n?.[8]||""),i.url=window?.location?.href||"",i.ref=p,i.cid=c,v&&(i.client_id=v),O&&(i.items=O),(r.indexOf("adview+")===0||r.indexOf("inlinkview+")===0||b&&i.session_id)&&(i.duration=e.duration||0,i.scroll_y=e.scroll_y,i.page_height=e.page_height,i.window_height=e.window_height,i.click_timestamp=n?.[9]||"");let y=`${q()}//${j()}/logs`;if(y+=`/clients/${encodeURIComponent(o)}`,y+=`/users/${encodeURIComponent(s)}/${r}`,d)for(let a=0;a<d.length;a++){let m=d[a]?.substring(1).split("=");i[m[0]]=C(m[1])}i.z=String(Math.round(Math.random()*1e6));let R=setTimeout(function(){t&&t()},2e3);B().then(a=>{a&&(i.user_agent=a),$(y,i,function(m){m!=="OK"&&h(m),(!(r.indexOf("adview+")===0||r.indexOf("inlinkview+")===0||r.indexOf("visit")===0)||!Y)&&(Q(o,r,v),Y=!0),R&&(clearTimeout(R),t&&t())})})}var ge=e=>{let t=0;G=new Date().getTime();let n=setInterval(function(){let o=new Date().getTime();o-G>he&&clearInterval(n),G=o,t=t+1,e.duration=t;try{let r=P();e.scroll_y=L(),e.page_height=r.window,e.window_height=r.viewport}catch{e.scroll_y=-1,e.page_height=-1,e.window_height=-1}S(e),_(x,w,V)},1e3)},z=(e,t,n)=>{setTimeout(function(){e.event_type=`adview+${t}`,e.duration=t;try{let o=P();e.scroll_y=L(),e.page_height=o.window,e.window_height=o.viewport}catch{e.scroll_y=-1,e.page_height=-1,e.window_height=-1}n?n(e):S(e)},t*1e3)},_e=(e,t)=>{let{count:n}=t;t.duration=n,S(t),(n===5||n===30)&&(e.event_type=`inlinkview+${n}`,e.duration=n,S(e))};function ee(e,t){let{client_name_or_account_id:n,uid:o,cid:r,cached_click:i,cached_conversion:s,client_id:c,items:l,data:f}=e,v=/[\?\&]dablena=([^\|]+)\|([^\|]+)\|([^\|]+)\|([^\|]+)\|([^\|\#\&]+)\|([^\|\#\&]+)(?:\|([^\|\#\&]+))(?:\|([^\|\#\&]+))(?:\|(\d+))?/,O=window?.location?.href?.match(/[\?\&]utm_[a-z]+=[^\#\&]+/g),N=C(window?.location?.href||"").match(v),d="visit";x=`__dbl__se_${c}`;let p=`__dbl__re_${c}`;b=!1;let y=!!u(x),R=!!u(p);(N||i)&&(f?.is_native?d="inlinkview":d="adview",y?w=u(x):(w=r.slice(0,3)+String(Math.round(A()*1e8)),_(p,1,pe)),b=!0,_(x,w,V)),d==="visit"&&(y||R)&&(y?w=u(x):R&&(w=r.slice(0,3)+String(Math.round(A()*1e8))),b=!0,_(x,w,V));let a={event_type:d,client_name_or_account_id:n,uid:o,cid:r,cached_click:i,cached_conversion:s,client_id:c,items:l},m={event_type:d,client_name_or_account_id:n,uid:o,cid:r,cached_click:i,cached_conversion:s,client_id:c,items:l,data:{session_id:w,user_page_id:me}};if(d==="inlinkview"){let{scroll_y:I,page_height:U,window_height:H,count:D}=f;Object.assign(a,{scroll_y:I},{page_height:U},{window_height:H},{count:D}),Object.assign(m,{scroll_y:I},{page_height:U},{window_height:H},{count:D}),_e(a,m)}Z&&(d==="adview"&&(z(a,5),z(a,30)),b&&d!=="inlinkview"&&ge(m),d==="visit"&&(!b||O)?S(a,t):t&&t(),f?.is_native&&(Z=!1))}function we(){if(window.fbq)return;let e=window.fbq=function(){return e.callMethod?e.callMethod.apply(e,arguments):e.queue.push(arguments)};window._fbq||(window._fbq=e),e.push=e,e.loaded=1,e.version="2.0",e.queue=[];let t=document.createElement("script");t.async=1,t.src="https://connect.facebook.net/en_US/fbevents.js";let n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)}function te(e,t){we(),window.fbq("init",`${e}`),window.fbq("track",t)}var xe=e=>/\d\d\d-\d\d\d-\d\d\d/.test(e)?Number(e.split("-").join("").substring(3)):null,Se={Visit:{type:"visit"},PageView:{type:"visit"},ViewContent:{type:"content"},Search:{type:"search"},AddToCart:{type:"cart"},AddToWishlist:{type:"wishlist"},InitialCheckout:{type:"checkout"},InitiateCheckout:{type:"checkout"},AddPaymentInfo:{type:"payment"},Purchase:{type:"purchase",validateData(e){if(!e?.value||!e?.currency)throw"value or currency did not defined."}},Lead:{type:"lead"},CompleteRegistration:{type:"registration"},event1:{type:"event1"},event2:{type:"event2"},event3:{type:"event3"}},E=class{cacheCookieName=void 0;cacheExpire=void 0;constructor(){this.cacheCookieName="dable_uid",this.cacheExpire=3*365*24*60*60*1e3}init(t){this.clientNameOrAccountId=t}track(t,n,o){if(typeof n=="function"&&(o=n,n=null),o||(o=function(){}),!this.clientNameOrAccountId){h("init should executed before executing track method"),o();return}if(document.location.href.indexOf("gtm-msr.appspot")>-1){o();return}let r=Se[t];try{if(r)r.validateData&&r.validateData(n);else throw`Invalid event code: ${t}`}catch(i){h(i)}this.fetchPrefs(i=>{this.fetchUID(s=>{if(i.sp_client===null){h(`Invalid ID: ${this.clientNameOrAccountId}`),o();return}i.sp_client?.facebook?.enabled&&i.sp_client?.facebook?.pixel_id&&te(i.sp_client.facebook.pixel_id,t),(t==="PageView"?ee:S)({client_name_or_account_id:this.clientNameOrAccountId,event_type:r.type,data:n,uid:s,cid:i.cid,cached_click:i.sp_client?.cached_click,cached_conversion:i.sp_client?.cached_conversion,client_id:i.sp_client?.client_id},o)})})}fetchPrefs(t){if(!this.clientNameOrAccountId){h("init should executed before executing fetchPrefs method");return}if(this.prefs){let s=this.clientNameOrAccountId===this.prefs.sp_client.client_name,c=xe(this.clientNameOrAccountId)===this.prefs.sp_client.client_id;if(s||c){t(this.prefs);return}}if(this.fetchPrefsQueue){this.fetchPrefsQueue.push(t);return}this.fetchPrefsQueue=[t];let n=u(this.cacheCookieName),o=window?.location?.href?.match(/[\?\&]ecid=([^\#\&]+)/)?.[1],r=window?.location?.href?.match(/[?&]request_id=([^#&]+)/)?.[1],i={paramUid:"",cached_uid:"",requestId:""};o&&(i.paramUid=o),r&&(i.requestId=r),n&&n!=="undefined"&&(i.cached_uid=n),$(`https://${W()}/plugin/services/${encodeURIComponent(this.clientNameOrAccountId)}/prefs2`,i,s=>{this.prefs=s&&s.result||null;for(let c=0;c<this.fetchPrefsQueue.length;c++){let l=this.fetchPrefsQueue[c];l(this.prefs)}this.fetchPrefsQueue=null,_(this.cacheCookieName,this.prefs.cid,this.cacheExpire)})}fetchUID(t){let n=function(){return String(Math.round(A()*9e7)+1e7)+"."+String(new Date().getTime())};if(this.uid){t(this.uid);return}this.fetchPrefs(o=>{let{cid:r}=o;t(r||n())})}};(e=>{let t=e.q||[];if(Array.isArray(t)){e.q=new T(new E);for(let n=0;n<t.length;n++){let o=t[n];e.q.push(o)}}})(window.dablena);})();
